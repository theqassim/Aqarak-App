<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <meta name="description" content="Ø£ÙØ¶Ù„ Ù…Ù†ØµØ© Ø¹Ù‚Ø§Ø±ÙŠØ© ÙÙŠ Ù…ØµØ± Ù„Ø¹Ø±Ø¶ ÙˆØ·Ù„Ø¨ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ù…Ø¬Ø§Ù†Ø§Ù‹." />
    <meta name="keywords" content="Ø¹Ù‚Ø§Ø±Ø§Øª Ù…ØµØ±, Ø´Ù‚Ù‚ Ù„Ù„Ø¨ÙŠØ¹, Ø§ÙŠØ¬Ø§Ø± Ø´Ù‚Ù‚, Ø¹Ù‚Ø§Ø±Ùƒ" />
    <title>Ø¹Ù‚Ø§Ø±Ùƒ - Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1c2630">
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8686960539652604" crossorigin="anonymous"></script>
    <script type="application/ld+json">
     { "@context": "https://schema.org", "@type": "RealEstateAgent", "name": "Ù…Ù†ØµØ© Ø¹Ù‚Ø§Ø±Ùƒ - Aqarak", "url": "https://aqarakeg.com", "logo": "https://aqarakeg.com/logo.jpg", "description": "Ù…Ù†ØµØ© Ø¹Ù‚Ø§Ø±Ùƒ Ù‡ÙŠ Ø§Ù„ÙˆØ¬Ù‡Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ø¨ÙŠØ¹ ÙˆØ´Ø±Ø§Ø¡ ÙˆØ¥ÙŠØ¬Ø§Ø± Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª ÙÙŠ Ù…ØµØ±." }
    </script>
    <style>
    /* --- ğŸ¨ 1. Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© --- */
    :root { --glass-bg: rgba(20, 20, 20, 0.98); --neon-primary: #00ff88; --neon-secondary: #00d4ff; --card-bg: #1a1a1a; --text-main: #ffffff; }
    body { background-color: #0f0f0f; background-image: radial-gradient(circle at 50% 0%, #1a2c25 0%, #0f0f0f 70%); min-height: 100vh; margin: 0 !important; padding: 0 !important; font-family: 'Cairo', sans-serif; overflow-x: hidden; }

    /* --- 2. Ø§Ù„Ù‡ÙŠØ¯Ø± (Desktop) --- */
    .main-header { position: sticky; top: 0; z-index: 1000; background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 5px 20px rgba(0,0,0,0.5); padding: 10px 15px; border-bottom-left-radius: 20px; border-bottom-right-radius: 20px; }
    .header-container { display: flex; justify-content: space-between; align-items: center; max-width: 1250px; margin: 0 auto; }
    .logo-container { display: flex; align-items: center; gap: 10px; color: white; font-weight: bold; font-size: 1.1rem; }
    .logo { height: 40px; width: 40px; object-fit: cover; border-radius: 50%; border: 2px solid var(--neon-primary); }
    .main-nav { display: flex; gap: 10px; flex-wrap: wrap; align-items: center;}
    .nav-button { background: transparent; color: #ddd; text-decoration: none; padding: 8px 15px; border-radius: 50px; border: 1px solid #444; font-size: 0.85rem; transition: 0.3s; }
    .nav-button:hover { border-color: var(--neon-primary); color: var(--neon-primary); }
    .sell-btn { background: var(--neon-primary) !important; color: #000000 !important; border: 1px solid var(--neon-primary) !important; padding: 8px 20px; border-radius: 50px; text-decoration: none; font-size: 0.9rem; font-weight: bold; box-shadow: 0 0 15px rgba(0, 255, 136, 0.4); transition: 0.3s; }
    .sell-btn:hover { background: transparent !important; color: var(--neon-primary) !important; box-shadow: 0 0 25px rgba(0, 255, 136, 0.7); }

    /* --- ğŸ“± Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Action Dock) --- */
    .mobile-header-custom {
        display: none; /* Ù…Ø®ÙÙŠ ÙÙŠ Ø§Ù„Ø¯ÙŠØ³ÙƒØªÙˆØ¨ */
        position: fixed; top: 0; left: 0; right: 0;
        height: 70px;
        background: rgba(10, 10, 10, 0.95);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        z-index: 9999;
        padding: 0 15px;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 5px 25px rgba(0,0,0,0.8);
    }

    /* Ø´Ø±ÙŠØ· Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª (The Action Dock) */
    .action-dock {
        flex: 1; display: flex; justify-content: center; align-items: center; gap: 15px; margin: 0 10px;
    }
    .dock-btn {
        width: 42px; height: 42px; border-radius: 12px;
        display: flex; align-items: center; justify-content: center;
        text-decoration: none; font-size: 1.2rem; cursor: pointer;
        transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        position: relative; overflow: hidden;
    }
    .dock-btn:active { transform: scale(0.9); }
    
    /* Ø²Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© (Ø§Ù„Ù…Ù…ÙŠØ²) */
    .btn-add-prop { background: linear-gradient(135deg, #00ff88, #00cc6a); color: black; box-shadow: 0 0 15px rgba(0, 255, 136, 0.3); border: 1px solid #00ff88; }
    /* Ø²Ø± Ø§Ù„Ù€ AI */
    .btn-ai-chat { background: rgba(255, 255, 255, 0.08); color: var(--neon-secondary); border: 1px solid rgba(0, 212, 255, 0.3); }
    /* Ø²Ø± Ø§Ù„Ø¨Ø­Ø« */
    .btn-quick-search { background: rgba(255, 255, 255, 0.08); color: #fff; border: 1px solid rgba(255, 255, 255, 0.1); }

    /* ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ ÙÙŠ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    .mobile-profile-container { position: relative; }
    .mobile-profile-img { width: 40px; height: 40px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.2); object-fit: cover; }

    /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    .mobile-dropdown {
        display: none; position: fixed; top: 75px; left: 15px; width: 240px;
        background: #1a1a1a; border: 1px solid var(--neon-primary); border-radius: 12px;
        padding: 10px; z-index: 10000; box-shadow: 0 10px 40px rgba(0,0,0,0.9);
        animation: dropIn 0.2s ease-out;
    }
    .dropdown-link { display: flex; align-items: center; gap: 10px; padding: 12px; color: white; text-decoration: none; border-radius: 8px; font-size: 0.9rem; margin-bottom: 5px; }
    .dropdown-link:hover { background: rgba(0, 255, 136, 0.1); color: var(--neon-primary); }
    @keyframes dropIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

    /* Media Query Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    @media (max-width: 768px) {
        .main-header { display: none !important; } /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ… */
        .mobile-header-custom { display: flex !important; } /* Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
        body { padding-top: 70px; } /* Ù…Ø³Ø§ÙØ© Ø¹Ø´Ø§Ù† Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø«Ø§Ø¨Øª */
        
        .search-bar-container { flex-direction: column; }
        .search-button { display: none; }
        .search-bar { border-radius: 50px !important; }
    }

    /* --- Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø³ØªØ§ÙŠÙ„Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ© --- */
    .search-section { padding: 30px 15px; text-align: center; max-width: 800px; margin: 0 auto; }
    .search-bar-container { position: relative; display: flex; gap: 10px; }
    .search-bar { width: 100%; padding: 15px 25px; background: rgba(0,0,0,0.6); border: 1px solid #444; border-radius: 50px; color: white; font-size: 1rem; transition: 0.3s; }
    .search-bar:focus { border-color: var(--neon-secondary); outline: none; box-shadow: 0 0 15px rgba(0, 212, 255, 0.2); }
    .search-button { background: var(--neon-secondary); color: #000; border: none; padding: 0 25px; border-radius: 50px; font-weight: bold; cursor: pointer; white-space: nowrap; transition: 0.3s; }
    
    .listings-section { max-width: 1250px; margin: 0 auto; padding: 0 15px 40px 15px; }
    .section-title { color: var(--neon-primary); margin-bottom: 20px; border-right: 4px solid var(--neon-primary); padding-right: 15px; font-size: 1.5rem; }
    .adv-grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px; }
    
    .adv-card { background: var(--card-bg); border-radius: 16px; overflow: hidden; border: 1px solid #333; transition: 0.3s; position: relative; display: flex; flex-direction: column; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
    .adv-card:hover { transform: translateY(-7px); border-color: var(--neon-primary); box-shadow: 0 15px 40px rgba(0, 255, 136, 0.2); }
    .adv-card-img-box { height: 220px; position: relative; }
    .adv-card-img { width: 100%; height: 100%; object-fit: cover; }
    .adv-price-tag { position: absolute; bottom: 10px; left: 10px; background: rgba(0,0,0,0.85); color: var(--neon-primary); padding: 5px 12px; border-radius: 8px; font-weight: bold; border: 1px solid var(--neon-primary); font-size: 1rem; }
    .adv-type-badge { position: absolute; top: 10px; left: 10px; padding: 5px 10px; border-radius: 6px; font-weight: bold; font-size: 0.8rem; color: black; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
    .is-sale { background: #00ff88; } .is-rent { background: #00d4ff; }
    .adv-card-body { padding: 15px; }
    .adv-title { color: white; margin: 0 0 12px 0; font-size: 1.1rem; line-height: 1.4; height: 3rem; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
    .adv-features { display: flex; gap: 15px; color: #bbb; font-size: 0.85rem; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 12px; }
    .adv-feat-item i { color: var(--neon-secondary); margin-left: 5px; }
    .adv-details-btn { display: block; width: 100%; text-align: center; border: 1px solid var(--neon-primary); color: var(--neon-primary); padding: 10px; border-radius: 8px; text-decoration: none; font-weight: bold; font-size: 0.95rem; transition: 0.3s; background: transparent; }
    .adv-details-btn:hover { background: var(--neon-primary); color: black; }
    .load-more-btn { background: transparent; color: white; border: 1px solid #555; padding: 12px 40px; border-radius: 50px; margin-top: 30px; cursor: pointer; transition: 0.3s; font-size: 1rem; }
    .load-more-btn:hover { border-color: var(--neon-primary); color: var(--neon-primary); box-shadow: 0 0 20px rgba(0, 255, 136, 0.3); }

    .featured-card-glow { border: 2px solid #FFD700 !important; box-shadow: 0 0 25px rgba(255, 215, 0, 0.25); position: relative; transform: scale(1.02); z-index: 5; background: linear-gradient(145deg, #1a1a1a, #2a2a2a) !important; transition: all 0.3s ease; }
    .featured-card-glow:hover { border-color: #FFA500 !important; box-shadow: 0 0 40px rgba(255, 215, 0, 0.5); transform: translateY(-7px) scale(1.03); }
    .featured-crown { position: absolute; top: 10px; right: 10px; background: linear-gradient(45deg, #FFD700, #FFA500, #FFD700); background-size: 200% 200%; color: black; font-weight: 900; padding: 6px 12px; border-radius: 8px; font-size: 0.85rem; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); z-index: 10; display: flex; align-items: center; gap: 6px; animation: goldShine 3s infinite linear; border: 1px solid #fff; }
    @keyframes goldShine { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }
    </style>
</head>
<body>

    <header class="mobile-header-custom">
        <a href="home" style="text-decoration:none;">
            <img src="logo.png" alt="Ø¹Ù‚Ø§Ø±Ùƒ" style="width:38px; height:38px; border-radius:50%; border:1px solid #444;">
        </a>

        <div class="action-dock">
            <div onclick="toggleChat()" class="dock-btn btn-ai-chat" title="Ù…Ø³Ø§Ø¹Ø¯ Ø¹Ù‚Ø§Ø±Ùƒ">
                <i class="fas fa-robot"></i>
            </div>
            
            <a href="seller-dashboard" class="dock-btn btn-add-prop" title="Ø£Ø¶Ù Ø¹Ù‚Ø§Ø±Ùƒ Ù…Ø¬Ø§Ù†Ø§Ù‹">
                <i class="fas fa-plus"></i>
            </a>

            <div onclick="document.getElementById('hero-search-section').scrollIntoView({behavior: 'smooth', block: 'center'})" class="dock-btn btn-quick-search" title="Ø¨Ø­Ø«">
                <i class="fas fa-search"></i>
            </div>
        </div>

        <div class="mobile-profile-container" id="mobile-auth-area">
            </div>

        <div id="mobile-profile-dropdown" class="mobile-dropdown">
            <div style="padding:10px; border-bottom:1px solid #333; margin-bottom:5px;">
                <strong style="color:white; display:block;" id="mob-user-name">...</strong>
                <span style="font-size:0.75rem; color:#00ff88;" id="mob-user-balance"></span>
            </div>
            <a href="user-dashboard" class="dropdown-link"><i class="fas fa-th-large"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
            <a href="user-dashboard?tab=fav" class="dropdown-link"><i class="fas fa-heart"></i> Ø§Ù„Ù…ÙØ¶Ù„Ø©</a>
            <a href="#" onclick="logoutUser()" class="dropdown-link" style="color:#ff4444;"><i class="fas fa-sign-out-alt"></i> Ø®Ø±ÙˆØ¬</a>
        </div>
    </header>

    <header class="main-header">
        <div class="header-container">
            <div class="logo-container">
                <img src="logo.png" alt="Ø´Ø¹Ø§Ø± Ø¹Ù‚Ø§Ø±Ùƒ" class="logo">
                <span class="logo-text">Ø¹Ù‚Ø§Ø±Ùƒ Ù…Ø¶Ù…ÙˆÙ†!</span>
            </div>
            <nav class="main-nav" id="dynamic-nav">
                </nav>
        </div>
    </header>

    <main class="main-content">
        <section class="search-section" id="hero-search-section">
            <div class="search-bar-container">
                <input type="text" class="search-bar neon-input-white" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù‚Ø§Ø±Ùƒ (Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø³Ø¹Ø±ØŒ Ø§Ù„ØºØ±Ù)...">
                <button class="search-button"><i class="fas fa-search"></i> Ø§Ø¨Ø­Ø«</button>
            </div>
        </section>

        <section class="listings-section">
            <h2 class="section-title">Ø£Ø­Ø¯Ø« Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</h2>
            <div class="listings-container" id="listings-container"></div>
        </section>
        
        <section class="request-property-section">
            <div class="request-box neon-glow centered-page-content">
                <p class="request-text">Ù„Ù… ØªØ¬Ø¯ Ø§Ù„Ø¹Ù‚Ø§Ø± Ø§Ù„Ø°ÙŠ ØªØ¨Ø­Ø« Ø¹Ù†Ù‡ØŸ</p>
                <a href="request-property" class="btn-neon-large">Ø§Ø­Ø¬Ø² Ø¹Ù‚Ø§Ø±Ùƒ Ø§Ù„Ø¢Ù†!</a>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="footer-content">
            <div class="social-links">
                <a href="https://www.facebook.com/share/17H591aR7r/" target="_blank"><i class="fab fa-facebook-f"></i></a>
                <a href="https://www.instagram.com/aqarak.eg?igsh=ZHZhd2U0NTg4MzAy" target="_blank"><i class="fab fa-instagram"></i></a>
                <a href="https://whatsapp.com/channel/0029Vb6YH08CxoAoe7aaSP38" target="_blank"><i class="fab fa-whatsapp"></i></a>
            </div>
            <p class="contact-info">ØªÙˆØ§ØµÙ„ÙˆØ§ Ù…Ø¹Ù†Ø§!</p>
            <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© 2025 - Ø¹Ù‚Ø§Ø±Ùƒ</p>
        </div>
    </footer>

    <button class="chatbot-toggler" onclick="toggleChat()">
        <i class="fas fa-robot"></i>
    </button>

    <div class="chatbot-window" id="chatbotWindow">
        <div class="chatbot-header">
            <div class="header-info">
                <img src="logo.png" alt="Logo" style="width: 30px; border-radius: 50%;">
                <div class="header-text">
                    <h4>Ù…Ø³Ø§Ø¹Ø¯ Ø¹Ù‚Ø§Ø±Ùƒ ğŸ </h4>
                    <p>Ù…ØªØ§Ø­ Ø§Ù„Ø¢Ù† Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</p>
                </div>
            </div>
            <span class="close-btn" onclick="toggleChat()">Ã—</span>
        </div>
        <ul class="chatbox" id="chatbox">
            <li class="chat incoming">
                <span class="bot-icon"><img src="logo.png" alt="Aqarak Bot"></span>
                <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ù†ØµØ© Ø¹Ù‚Ø§Ø±Ùƒ! ğŸ‘‹<br>Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ.. Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ğŸ‘‡</p>
            </li>
        </ul>
        <div class="suggestions-container">
            <button class="suggestion-chip" onclick="sendSuggestion('ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŸ')">ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŸ</button>
            <button class="suggestion-chip" onclick="sendSuggestion('Ø§ÙŠÙ‡ Ø§Ù„Ø´Ù‚Ù‚ Ø§Ù„Ù…ØªØ§Ø­Ø©ØŸ')">Ø§ÙŠÙ‡ Ø§Ù„Ø´Ù‚Ù‚ Ø§Ù„Ù…ØªØ§Ø­Ø©ØŸ</button>
            <button class="suggestion-chip" onclick="sendSuggestion('Ø§Ø²Ø§ÙŠ Ø§ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø§Ù„ÙƒØŸ')">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙˆØ§ØµÙ„</button>
        </div>
        <div class="chat-input">
            <textarea id="userMessage" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." required></textarea>
            <span id="micBtn" onclick="startVoiceInput()"><i class="fas fa-microphone"></i></span>
            <span id="sendBtn"><i class="fas fa-paper-plane"></i></span>
        </div>
    </div>

    <button onclick="openComplaintModal()" class="complaint-float-btn">
        <i class="fas fa-exclamation-circle"></i> Ø¹Ù†Ø¯Ùƒ Ø´ÙƒÙˆÙ‰ØŸ
    </button>

    <div id="complaint-modal" class="popup-overlay" style="display: none;">
        <div class="popup-content neon-glow" style="max-width: 400px; border-color: #ff4444;">
            <span class="close-btn" onclick="closeComplaintModal()" style="position:absolute; top:10px; left:15px; cursor:pointer; font-size:1.5rem;">&times;</span>
            <div style="text-align: center; margin-bottom: 15px;">
                <i class="fas fa-headset" style="font-size: 3rem; color: #ff4444;"></i>
                <h3 style="color: white; margin-top: 10px;">Ø¥Ø±Ø³Ø§Ù„ Ø´ÙƒÙˆÙ‰ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
            </div>
            <form id="user-complaint-form">
                <div class="input-group full-width">
                    <textarea id="complaint-text" class="neon-input-white" rows="4" placeholder="Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´ÙƒÙˆÙ‰ Ù‡Ù†Ø§..." required style="background: #222; border-color: #555;"></textarea>
                </div>
                <button type="submit" class="btn-neon-auth" style="width: 100%; border-color: #ff4444; color: #ff4444;">
                    <i class="fas fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø´ÙƒÙˆÙ‰
                </button>
            </form>
        </div>
    </div>

    <style>
        .complaint-float-btn { position: fixed; bottom: 20px; left: 20px; background: rgba(255, 68, 68, 0.1); color: #ff4444; border: 1px solid #ff4444; padding: 10px 20px; border-radius: 50px; font-weight: bold; cursor: pointer; z-index: 9999; transition: 0.3s; backdrop-filter: blur(5px); }
        .complaint-float-btn:hover { background: #ff4444; color: white; transform: translateY(-3px); }
        .chatbot-toggler { position: fixed; bottom: 85px; right: 25px; left: auto; height: 60px; width: 60px; border-radius: 50%; background: #007bff; color: #fff; border: none; font-size: 28px; cursor: pointer; z-index: 99999; transition: transform 0.3s; box-shadow: 0 0 15px rgba(0,123,255,0.6); }
        .chatbot-toggler:hover { transform: scale(1.1); background: #0056b3; }
        .chatbot-window { position: fixed; right: 25px; left: auto; bottom: 155px; width: 90%; max-width: 450px; height: 75vh; max-height: 650px; background: #1c2630; border: 1px solid #333; border-radius: 15px; overflow: hidden; opacity: 0; pointer-events: none; transform: scale(0.5); transform-origin: bottom right; box-shadow: 0 0 30px rgba(0,0,0,0.5); transition: all 0.3s; z-index: 100000; display: flex; flex-direction: column; }
        .chatbot-window.show-chat { opacity: 1; pointer-events: auto; transform: scale(1); }
        .chatbot-header { background: #0d141b; padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; flex-shrink: 0; }
        .header-info { display: flex; align-items: center; gap: 10px; }
        .header-text h4 { margin: 0; font-size: 1rem; color: #fff; }
        .header-text p { margin: 0; font-size: 0.7rem; color: #00ff41; }
        .close-btn { cursor: pointer; color: #fff; font-size: 1.5rem; }
        .chatbox { flex-grow: 1; overflow-y: auto; padding: 20px; list-style: none; margin: 0; background: #1c2630; }
        .chatbox .chat { display: flex; list-style: none; margin-bottom: 20px; }
        .chatbox .chat p { padding: 12px 16px; border-radius: 15px; max-width: 80%; font-size: 0.95rem; margin: 0; word-wrap: break-word; line-height: 1.6; }
        .chatbox .incoming .bot-icon { width: 35px; height: 35px; margin-left: 10px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
        .chatbox .incoming .bot-icon img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
        .chatbox .incoming p { background: #2c3e50; color: #fff; border-radius: 15px 0 15px 15px; }
        .chatbox .outgoing { justify-content: flex-end; }
        .chatbox .outgoing p { background: #007bff; color: #fff; border-radius: 0 15px 15px 15px; }
        .chatbox a { color: #4facfe; text-decoration: underline; font-weight: bold; }
        .suggestions-container { display: flex; gap: 8px; padding: 10px 15px; overflow-x: auto; background: #1c2630; border-top: 1px solid #333; scrollbar-width: thin; }
        .suggestion-chip { background: rgba(0,123,255,0.1); color: #007bff; border: 1px solid #007bff; border-radius: 20px; padding: 8px 15px; font-size: 0.85rem; cursor: pointer; white-space: nowrap; }
        .chat-input { display: flex; gap: 10px; padding: 15px; background: #0d141b; border-top: 1px solid #333; flex-shrink: 0; align-items: center; }
        .chat-input textarea { height: auto; min-height: 50px; max-height: 150px; width: 100%; border: none; outline: none; resize: none; background: #2c3e50; color: #fff; padding: 12px; border-radius: 10px; font-family: inherit; font-size: 0.95rem; overflow-y: hidden; }
        .chat-input span { color: #007bff; cursor: pointer; font-size: 1.3rem; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; }
        .recording { color: red !important; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
        body.no-scroll { overflow: hidden !important; height: 100vh; }
        .popup-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 99999; justify-content: center; align-items: center; backdrop-filter: blur(4px); }
        .popup-content { background: #121212; padding: 40px; border-radius: 20px; text-align: center; width: 90%; max-width: 450px; border: 1px solid #333; box-shadow: 0 20px 50px rgba(0,0,0,0.8); animation: popIn 0.5s; color: #fff; }
        @keyframes popIn { from { opacity: 0; transform: scale(0.5); } to { opacity: 1; transform: scale(1); } }
    </style>

    <script>
        // Ø§Ù„Ø´Ø§Øª Ø¨ÙˆØª ÙˆØ§Ù„Ø´ÙƒØ§ÙˆÙŠ
        const chatInput = document.querySelector("#userMessage");
        const sendChatBtn = document.querySelector("#sendBtn");
        const chatbox = document.querySelector(".chatbox");
        const chatbotWindow = document.querySelector("#chatbotWindow");
        const micBtn = document.querySelector("#micBtn");
        const suggestionsBox = document.querySelector(".suggestions-container");
        let userMessage;

        const toggleChat = () => {
            chatbotWindow.classList.toggle("show-chat");
            document.body.classList.toggle("no-scroll");
        }

        chatInput.addEventListener("input", () => {
            chatInput.style.height = "auto";
            chatInput.style.height = `${chatInput.scrollHeight}px`;
        });

        const startVoiceInput = () => {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SpeechRecognition) return alert("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„ØµÙˆØª");
            const recognition = new SpeechRecognition();
            recognition.lang = 'ar-EG';
            recognition.onstart = () => { micBtn.classList.add("recording"); chatInput.placeholder = "ØªØ­Ø¯Ø«..."; };
            recognition.onend = () => { micBtn.classList.remove("recording"); chatInput.placeholder = "Ø§ÙƒØªØ¨..."; };
            recognition.onresult = (e) => { chatInput.value = e.results[0][0].transcript; chatInput.dispatchEvent(new Event('input')); };
            recognition.start();
        }

        const sendSuggestion = (text) => { chatInput.value = text; handleChat(); }

        const createChatLi = (message, className) => {
            const chatLi = document.createElement("li");
            chatLi.classList.add("chat", className);
            let chatContent = className === "incoming" ? `<span class="bot-icon"><img src="logo.png" alt="Bot"></span><p>${message}</p>` : `<p>${message}</p>`;
            chatLi.innerHTML = chatContent;
            return chatLi;
        }

        const handleChat = () => {
            userMessage = chatInput.value.trim();
            if(!userMessage) return;
            if(suggestionsBox) suggestionsBox.style.display = "none";
            chatbox.appendChild(createChatLi(userMessage, "outgoing"));
            chatbox.scrollTo(0, chatbox.scrollHeight);
            chatInput.value = "";
            setTimeout(async () => {
                const incomingChatLi = createChatLi("...", "incoming");
                chatbox.appendChild(incomingChatLi);
                chatbox.scrollTo(0, chatbox.scrollHeight);
                try {
                    const response = await fetch("/api/chat", { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ message: userMessage }) });
                    const data = await response.json();
                    incomingChatLi.querySelector("p").innerHTML = data.reply.replace(/\n/g, '<br>');
                } catch (error) { incomingChatLi.querySelector("p").textContent = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„"; }
            }, 600);
        }

        sendChatBtn.addEventListener("click", handleChat);
        
        function openComplaintModal() { document.getElementById('complaint-modal').style.display = 'flex'; }
        function closeComplaintModal() { document.getElementById('complaint-modal').style.display = 'none'; }
        
        document.getElementById('user-complaint-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const text = document.getElementById('complaint-text').value;
            btn.innerHTML = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...'; btn.disabled = true;
            try {
                const res = await fetch('/api/submit-complaint', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ content: text }) });
                const data = await res.json();
                if(res.ok) { alert('âœ… ' + data.message); closeComplaintModal(); } else alert(data.message);
            } catch(err) { alert('Ø®Ø·Ø£'); } finally { btn.innerHTML = 'Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø´ÙƒÙˆÙ‰'; btn.disabled = false; }
        });
    </script>
    
    <script src="home.js"></script>
    <script src="search-handler.js"></script>
    <script src="ban-check.js"></script>
    <script src="global-alert.js"></script>
</body>
</html>
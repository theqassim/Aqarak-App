<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¬ÙˆÙ„Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ | Ø¹Ù‚Ø§Ø±Ùƒ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { margin: 0; background: #0f172a; color: white; font-family: 'Cairo', sans-serif; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .header { padding: 20px; display: flex; justify-content: space-between; align-items: center; z-index: 10; }
        .close-btn { background: rgba(255,255,255,0.1); border: none; color: white; padding: 10px 20px; border-radius: 30px; cursor: pointer; font-size: 1rem; transition: 0.3s; }
        .close-btn:hover { background: #e74c3c; }
        
        .player-wrapper { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; width: 100%; }
        .video-box { width: 90%; max-width: 900px; aspect-ratio: 16/9; background: black; border-radius: 20px; overflow: hidden; box-shadow: 0 0 50px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1); position: relative; }
        iframe { width: 100%; height: 100%; border: none; }

        .controls { margin-top: 20px; display: flex; gap: 20px; align-items: center; background: rgba(255,255,255,0.1); padding: 10px 30px; border-radius: 50px; backdrop-filter: blur(10px); }
        .nav-btn { background: transparent; border: 1px solid rgba(255,255,255,0.3); color: white; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.3s; }
        .nav-btn:hover { background: white; color: #0f172a; }
        .nav-btn:disabled { opacity: 0.3; cursor: not-allowed; background: transparent; color: white; }
        .counter { font-size: 1.2rem; font-weight: bold; letter-spacing: 2px; }
    </style>
</head>
<body>

    <div class="header">
        <h3>ğŸ¥ Ø¬ÙˆÙ„Ø© ÙÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±</h3>
        <button class="close-btn" onclick="history.back()">Ø¥ØºÙ„Ø§Ù‚ âœ•</button>
    </div>

    <div class="player-wrapper">
        <div class="video-box">
            <iframe id="youtube-frame" src="" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>

        <div class="controls">
            <button class="nav-btn" id="prev-btn" onclick="changeVideo(-1)"><i class="fas fa-chevron-right"></i></button>
            <div class="counter"><span id="current">1</span> / <span id="total">1</span></div>
            <button class="nav-btn" id="next-btn" onclick="changeVideo(1)"><i class="fas fa-chevron-left"></i></button>
        </div>
    </div>

    <script>
        const videos = JSON.parse(localStorage.getItem('activePropertyVideos') || "[]");
        let currentIndex = 0;

        const frame = document.getElementById('youtube-frame');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const currentSpan = document.getElementById('current');
        const totalSpan = document.getElementById('total');

        function getYouTubeID(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function loadVideo(index) {
            if (videos.length === 0) return;
            
            const videoId = getYouTubeID(videos[index]);
            if (videoId) {
                // Ø¥Ø¶Ø§ÙØ© modestbranding Ù„Ø¥Ø®ÙØ§Ø¡ Ø´Ø¹Ø§Ø± ÙŠÙˆØªÙŠÙˆØ¨ ÙˆØ´Ø±ÙŠØ· Ø§Ù„ØªØ­ÙƒÙ…
                frame.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1&showinfo=0`;
            }

            currentSpan.innerText = index + 1;
            totalSpan.innerText = videos.length;
            
            prevBtn.disabled = (index === 0);
            nextBtn.disabled = (index === videos.length - 1);
        }

        function changeVideo(direction) {
            const newIndex = currentIndex + direction;
            if (newIndex >= 0 && newIndex < videos.length) {
                currentIndex = newIndex;
                loadVideo(currentIndex);
            }
        }

        if (videos.length > 0) {
            loadVideo(0);
        } else {
            alert("Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù„Ù„Ø¹Ø±Ø¶");
            history.back();
        }
    </script>
</body>
</html>
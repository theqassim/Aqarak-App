const egyptLocations = {
  ÿßŸÑŸÇÿßŸáÿ±ÿ©: [
    "ÿßŸÑÿ™ÿ¨ŸÖÿπ ÿßŸÑÿÆÿßŸÖÿ≥",
    "ŸÖÿØŸäŸÜÿ© ŸÜÿµÿ±",
    "ÿßŸÑŸÖÿπÿßÿØŸä",
    "ŸÖÿµÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ©",
    "ÿßŸÑÿ¥ÿ±ŸàŸÇ",
    "ŸÖÿØŸäŸÜÿ™Ÿä",
    "ÿßŸÑÿ±ÿ≠ÿßÿ®",
    "ÿßŸÑÿπÿßÿµŸÖÿ© ÿßŸÑÿ•ÿØÿßÿ±Ÿäÿ©",
    "ÿßŸÑŸÖŸÇÿ∑ŸÖ",
    "ÿßŸÑÿ≤Ÿäÿ™ŸàŸÜ",
    "ÿπŸäŸÜ ÿ¥ŸÖÿ≥",
    "ÿ¥ÿ®ÿ±ÿß",
    "ÿ≠ŸÑŸàÿßŸÜ",
    "ÿßŸÑŸÖÿ±ÿ¨",
    "Ÿàÿ≥ÿ∑ ÿßŸÑÿ®ŸÑÿØ",
    "ÿ¨ÿßÿ±ÿØŸÜ ÿ≥Ÿäÿ™Ÿä",
    "ÿßŸÑÿ≤ŸÖÿßŸÑŸÉ",
    "ÿßŸÑŸÖŸÜŸäŸÑ",
    "ÿ≠ÿØÿßÿ¶ŸÇ ÿßŸÑŸÇÿ®ÿ©",
    "ÿßŸÑÿπÿ®ÿßÿ≥Ÿäÿ©",
    "ÿßŸÑŸÖÿ∑ÿ±Ÿäÿ©",
    "ÿßŸÑÿ≥ŸäÿØÿ© ÿ≤ŸäŸÜÿ®",
    "ÿßŸÑŸàÿßŸäŸÑŸä",
    "ÿ®ÿßÿ® ÿßŸÑÿ¥ÿπÿ±Ÿäÿ©",
    "ŸÖÿµÿ± ÿßŸÑŸÇÿØŸäŸÖÿ©",
    "ÿπÿßÿ®ÿØŸäŸÜ",
    "ÿßŸÑŸÖŸàÿ≥ŸÉŸä",
    "ÿßŸÑÿ£ÿ≤ÿ®ŸÉŸäÿ©",
    "ÿßŸÑÿ¨ŸÖÿßŸÑŸäÿ©",
    "ÿ®ŸàŸÑÿßŸÇ",
    "ÿßŸÑŸÜÿ≤Ÿáÿ©",
    "ÿßŸÑÿ≥ŸÑÿßŸÖ",
    "ÿßŸÑÿ®ÿ≥ÿßÿ™ŸäŸÜ",
    "ÿØÿßÿ± ÿßŸÑÿ≥ŸÑÿßŸÖ",
    "ÿ∑ÿ±Ÿá",
    "15 ŸÖÿßŸäŸà",
    "ÿßŸÑÿ™ÿ®ŸäŸÜ",
    "ÿ®ÿØÿ±",
  ],
  ÿßŸÑÿ¨Ÿäÿ≤ÿ©: [
    "6 ÿ£ŸÉÿ™Ÿàÿ®ÿ±",
    "ÿßŸÑÿ¥ŸäÿÆ ÿ≤ÿßŸäÿØ",
    "ÿßŸÑŸáÿ±ŸÖ",
    "ŸÅŸäÿµŸÑ",
    "ÿßŸÑÿØŸÇŸä",
    "ÿßŸÑŸÖŸáŸÜÿØÿ≥ŸäŸÜ",
    "ÿßŸÑÿπÿ¨Ÿàÿ≤ÿ©",
    "ÿ•ŸÖÿ®ÿßÿ®ÿ©",
    "ÿ≠ÿØÿßÿ¶ŸÇ ÿßŸÑÿ£Ÿáÿ±ÿßŸÖ",
    "ÿßŸÑŸàÿ±ÿßŸÇ",
    "ÿ®ŸàŸÑÿßŸÇ ÿßŸÑÿØŸÉÿ±Ÿàÿ±",
    "ÿßŸÑŸÖŸÜŸäÿ®",
    "ÿßŸÑÿ®ÿØÿ±ÿ¥ŸäŸÜ",
    "ÿßŸÑÿπŸäÿßÿ∑",
    "ÿßŸÑÿµŸÅ",
    "ÿ£ÿ∑ŸÅŸäÿ≠",
    "ŸÉÿ±ÿØÿßÿ≥ÿ©",
    "ÿ£Ÿàÿ≥ŸäŸÖ",
    "ÿßŸÑÿ≠ŸàÿßŸÖÿØŸäÿ©",
    "ÿ£ÿ®Ÿà ÿßŸÑŸÜŸÖÿ±ÿ≥",
    "ŸÖŸÜÿ¥ÿ£ÿ© ÿßŸÑŸÇŸÜÿßÿ∑ÿ±",
    "ÿßŸÑŸàÿßÿ≠ÿßÿ™ ÿßŸÑÿ®ÿ≠ÿ±Ÿäÿ©",
  ],
  ÿßŸÑÿ•ÿ≥ŸÉŸÜÿØÿ±Ÿäÿ©: [
    "ÿ≥ŸÖŸàÿ≠ÿ©",
    "ŸÖŸäÿßŸÖŸä",
    "ÿßŸÑŸÖŸÜÿ™ÿ≤Ÿá",
    "ÿßŸÑÿπÿ¨ŸÖŸä",
    "ÿ≥ŸäÿØŸä ÿ®ÿ¥ÿ±",
    "ÿßŸÑÿ•ÿ®ÿ±ÿßŸáŸäŸÖŸäÿ©",
    "ŸÉÿßŸÖÿ® ÿ¥Ÿäÿ≤ÿßÿ±",
    "ÿßŸÑÿ¥ÿßÿ∑ÿ®Ÿä",
    "ŸÖÿ≠ÿ±ŸÖ ÿ®ŸÉ",
    "ÿßŸÑÿπÿµÿßŸÅÿ±ÿ©",
    "ÿßŸÑŸÖŸÜÿØÿ±ÿ©",
    "ÿ≥ÿßŸÜ ÿ≥ÿ™ŸäŸÅÿßŸÜŸà",
    "ÿ¨ŸÑŸäŸÖ",
    "ÿ±ÿ¥ÿØŸä",
    "ŸÉŸÅÿ± ÿπÿ®ÿØŸá",
    "ÿ≥ŸäÿØŸä ÿ¨ÿßÿ®ÿ±",
    "ÿßŸÑÿ≥ÿßÿ≠ŸÑ ÿßŸÑÿ¥ŸÖÿßŸÑŸä",
    "ÿ®ÿ±ÿ¨ ÿßŸÑÿπÿ±ÿ®",
    "ÿßŸÑÿ®Ÿäÿ∑ÿßÿ¥",
    "ÿßŸÑŸáÿßŸÜŸàŸÅŸäŸÑ",
    "ÿßŸÑÿπÿßŸÖÿ±Ÿäÿ©",
    "ÿßŸÑÿØÿÆŸäŸÑÿ©",
    "ÿßŸÑŸÖŸÉÿ≥",
    "ÿßŸÑŸÑÿ®ÿßŸÜ",
    "ÿßŸÑÿ¨ŸÖÿ±ŸÉ",
    "ÿßŸÑŸÖŸÜÿ¥Ÿäÿ©",
    "ÿßŸÑÿπÿ∑ÿßÿ±ŸäŸÜ",
    "ŸÉÿ±ŸÖŸàÿ≤",
  ],
  ÿßŸÑŸÇŸÑŸäŸàÿ®Ÿäÿ©: [
    "ÿ®ŸÜŸáÿß",
    "ÿ¥ÿ®ÿ±ÿß ÿßŸÑÿÆŸäŸÖÿ©",
    "ŸÇŸÑŸäŸàÿ®",
    "ÿßŸÑÿÆÿßŸÜŸÉÿ©",
    "ÿßŸÑŸÇŸÜÿßÿ∑ÿ± ÿßŸÑÿÆŸäÿ±Ÿäÿ©",
    "ÿ∑ŸàÿÆ",
    "ÿßŸÑÿπÿ®Ÿàÿ±",
    "ŸÉŸÅÿ± ÿ¥ŸÉÿ±",
    "ÿ¥ÿ®ŸäŸÜ ÿßŸÑŸÇŸÜÿßÿ∑ÿ±",
    "ŸÇŸáÿß",
    "ÿßŸÑÿÆÿµŸàÿµ",
  ],
  ÿßŸÑÿØŸÇŸáŸÑŸäÿ©: [
    "ÿßŸÑŸÖŸÜÿµŸàÿ±ÿ©",
    "ÿ∑ŸÑÿÆÿß",
    "ŸÖŸäÿ™ ÿ∫ŸÖÿ±",
    "ÿßŸÑÿ≥ŸÜÿ®ŸÑÿßŸàŸäŸÜ",
    "ÿØŸÉÿ±ŸÜÿ≥",
    "ÿ®ŸÑŸÇÿßÿ≥",
    "ÿßÿ¨ÿß",
    "ÿ¥ÿ±ÿ®ŸäŸÜ",
    "ŸÖŸÜŸäÿ© ÿßŸÑŸÜÿµÿ±",
    "ÿßŸÑŸÖŸÜÿ≤ŸÑÿ©",
    "ÿßŸÑŸÖÿ∑ÿ±Ÿäÿ©",
    "ÿßŸÑÿ¨ŸÖÿßŸÑŸäÿ©",
    "ŸÜÿ®ÿ±ŸàŸá",
    "ÿ™ŸÖŸâ ÿßŸÑÿ£ŸÖÿØŸäÿØ",
    "ÿ®ŸÜŸä ÿπÿ®ŸäÿØ",
    "ŸÖŸäÿ™ ÿ≥ŸÑÿ≥ŸäŸÑ",
    "ŸÖÿ≠ŸÑÿ© ÿØŸÖŸÜÿ©",
  ],
  ÿßŸÑÿ¥ÿ±ŸÇŸäÿ©: [
    "ÿßŸÑÿ≤ŸÇÿßÿ≤ŸäŸÇ",
    "ÿßŸÑÿπÿßÿ¥ÿ± ŸÖŸÜ ÿ±ŸÖÿ∂ÿßŸÜ",
    "ŸÖŸÜŸäÿß ÿßŸÑŸÇŸÖÿ≠",
    "ÿ®ŸÑÿ®Ÿäÿ≥",
    "ŸÅÿßŸÇŸàÿ≥",
    "ÿ£ÿ®Ÿà ÿ≠ŸÖÿßÿØ",
    "ÿØŸäÿ±ÿ® ŸÜÿ¨ŸÖ",
    "ŸáŸáŸäÿß",
    "ÿ£ÿ®Ÿà ŸÉÿ®Ÿäÿ±",
    "ŸÉŸÅÿ± ÿµŸÇÿ±",
    "ÿ£ŸàŸÑÿßÿØ ÿµŸÇÿ±",
    "ŸÖÿ¥ÿ™ŸàŸÑ ÿßŸÑÿ≥ŸàŸÇ",
    "ÿßŸÑÿ•ÿ®ÿ±ÿßŸáŸäŸÖŸäÿ©",
    "ÿßŸÑÿ≠ÿ≥ŸäŸÜŸäÿ©",
    "ÿµÿßŸÜ ÿßŸÑÿ≠ÿ¨ÿ±",
    "ÿßŸÑŸÇŸÜÿßŸäÿßÿ™",
    "ÿßŸÑŸÇÿ±ŸäŸÜ",
  ],
  ÿßŸÑÿ∫ÿ±ÿ®Ÿäÿ©: [
    "ÿ∑ŸÜÿ∑ÿß",
    "ÿßŸÑŸÖÿ≠ŸÑÿ© ÿßŸÑŸÉÿ®ÿ±Ÿâ",
    "ŸÉŸÅÿ± ÿßŸÑÿ≤Ÿäÿßÿ™",
    "ÿ≤ŸÅÿ™Ÿâ",
    "ÿßŸÑÿ≥ŸÜÿ∑ÿ©",
    "ÿ®ÿ≥ŸäŸàŸÜ",
    "ŸÇÿ∑Ÿàÿ±",
    "ÿ≥ŸÖŸÜŸàÿØ",
  ],
  ÿßŸÑŸÖŸÜŸàŸÅŸäÿ©: [
    "ÿ¥ÿ®ŸäŸÜ ÿßŸÑŸÉŸàŸÖ",
    "ŸÖÿØŸäŸÜÿ© ÿßŸÑÿ≥ÿßÿØÿßÿ™",
    "ŸÖŸÜŸàŸÅ",
    "ÿ£ÿ¥ŸÖŸàŸÜ",
    "ŸÇŸàŸäÿ≥ŸÜÿß",
    "ÿ™ŸÑÿß",
    "ÿßŸÑÿ®ÿßÿ¨Ÿàÿ±",
    "ÿßŸÑÿ¥ŸáÿØÿßÿ°",
    "ÿ®ÿ±ŸÉÿ© ÿßŸÑÿ≥ÿ®ÿπ",
    "ÿ≥ÿ±ÿ≥ ÿßŸÑŸÑŸäÿßŸÜ",
  ],
  ÿßŸÑÿ®ÿ≠Ÿäÿ±ÿ©: [
    "ÿØŸÖŸÜŸáŸàÿ±",
    "ŸÉŸÅÿ± ÿßŸÑÿØŸàÿßÿ±",
    "ÿ•Ÿäÿ™ÿßŸä ÿßŸÑÿ®ÿßÿ±ŸàÿØ",
    "ÿ£ÿ®Ÿà ÿ≠ŸÖÿµ",
    "ÿ±ÿ¥ŸäÿØ",
    "ŸÉŸàŸÖ ÿ≠ŸÖÿßÿØÿ©",
    "ŸàÿßÿØŸä ÿßŸÑŸÜÿ∑ÿ±ŸàŸÜ",
    "ÿ£ÿ®Ÿà ÿßŸÑŸÖÿ∑ÿßŸÖŸäÿ±",
    "ÿßŸÑÿØŸÑŸÜÿ¨ÿßÿ™",
    "ÿ≠Ÿàÿ¥ ÿπŸäÿ≥Ÿâ",
    "ÿßŸÑŸÖÿ≠ŸÖŸàÿØŸäÿ©",
    "ÿßŸÑÿ±ÿ≠ŸÖÿßŸÜŸäÿ©",
    "ÿ¥ÿ®ÿ±ÿßÿÆŸäÿ™",
    "ÿßÿØŸÉŸà",
    "ÿßŸÑŸÜŸàÿ®ÿßÿ±Ÿäÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©",
  ],
  ÿØŸÖŸäÿßÿ∑: [
    "ÿØŸÖŸäÿßÿ∑",
    "ÿ±ÿ£ÿ≥ ÿßŸÑÿ®ÿ±",
    "ÿØŸÖŸäÿßÿ∑ ÿßŸÑÿ¨ÿØŸäÿØÿ©",
    "ŸÅÿßÿ±ÿ≥ŸÉŸàÿ±",
    "ÿßŸÑÿ≤ÿ±ŸÇÿß",
    "ŸÉŸÅÿ± ÿ≥ÿπÿØ",
    "ÿßŸÑÿ≥ÿ±Ÿà",
    "ÿßŸÑÿ±Ÿàÿ∂ÿ©",
    "ŸÖŸäÿ™ ÿ£ÿ®Ÿà ÿ∫ÿßŸÑÿ®",
    "ÿπÿ≤ÿ®ÿ© ÿßŸÑÿ®ÿ±ÿ¨",
  ],
  ÿ®Ÿàÿ±ÿ≥ÿπŸäÿØ: [
    "ÿ®Ÿàÿ±ÿ≥ÿπŸäÿØ",
    "ÿ®Ÿàÿ±ŸÅÿ§ÿßÿØ",
    "ÿ≠Ÿä ÿßŸÑÿ¥ÿ±ŸÇ",
    "ÿ≠Ÿä ÿßŸÑÿπÿ±ÿ®",
    "ÿ≠Ÿä ÿßŸÑŸÖŸÜÿßÿÆ",
    "ÿ≠Ÿä ÿßŸÑÿ∂Ÿàÿßÿ≠Ÿä",
    "ÿ≠Ÿä ÿßŸÑÿ¨ŸÜŸàÿ®",
    "ÿ≠Ÿä ÿßŸÑÿ≤ŸáŸàÿ±",
  ],
  ÿßŸÑÿßÿ≥ŸÖÿßÿπŸäŸÑŸäÿ©: [
    "ÿßŸÑÿßÿ≥ŸÖÿßÿπŸäŸÑŸäÿ©",
    "ÿßŸÑÿ™ŸÑ ÿßŸÑŸÉÿ®Ÿäÿ±",
    "ŸÅÿßŸäÿØ",
    "ÿßŸÑŸÇŸÜÿ∑ÿ±ÿ© ÿ¥ÿ±ŸÇ",
    "ÿßŸÑŸÇŸÜÿ∑ÿ±ÿ© ÿ∫ÿ±ÿ®",
    "ÿ£ÿ®Ÿà ÿµŸàŸäÿ±",
    "ÿßŸÑŸÇÿµÿßÿµŸäŸÜ",
  ],
  ÿßŸÑÿ≥ŸàŸäÿ≥: ["ÿßŸÑÿ≥ŸàŸäÿ≥", "ÿßŸÑÿ£ÿ±ÿ®ÿπŸäŸÜ", "ÿπÿ™ÿßŸÇÿ©", "ÿßŸÑÿ¨ŸÜÿßŸäŸÜ", "ŸÅŸäÿµŸÑ"],
  "ŸÉŸÅÿ± ÿßŸÑÿ¥ŸäÿÆ": [
    "ŸÉŸÅÿ± ÿßŸÑÿ¥ŸäÿÆ",
    "ÿØÿ≥ŸàŸÇ",
    "ŸÅŸàŸá",
    "ŸÖÿ∑Ÿàÿ®ÿ≥",
    "ÿ®ŸÑÿ∑ŸäŸÖ",
    "ÿ≥ŸäÿØŸä ÿ≥ÿßŸÑŸÖ",
    "ÿ®ŸäŸÑÿß",
    "ÿßŸÑÿ≠ÿßŸÖŸàŸÑ",
    "ŸÇŸÑŸäŸÜ",
    "ÿßŸÑÿ±Ÿäÿßÿ∂",
    "ÿ®ÿ±ÿ¨ ÿßŸÑÿ®ÿ±ŸÑÿ≥",
  ],
  ÿßŸÑŸÅŸäŸàŸÖ: ["ÿßŸÑŸÅŸäŸàŸÖ", "ÿ≥ŸÜŸàÿ±ÿ≥", "ÿ•ÿ∑ÿ≥ÿß", "ÿ∑ÿßŸÖŸäÿ©", "ÿ£ÿ®ÿ¥ŸàÿßŸä", "ŸäŸàÿ≥ŸÅ ÿßŸÑÿµÿØŸäŸÇ"],
  "ÿ®ŸÜŸä ÿ≥ŸàŸäŸÅ": [
    "ÿ®ŸÜŸä ÿ≥ŸàŸäŸÅ",
    "ÿßŸÑŸàÿßÿ≥ÿ∑Ÿâ",
    "ŸÜÿßÿµÿ±",
    "ÿßŸáŸÜÿßÿ≥Ÿäÿß",
    "ÿ®ÿ®ÿß",
    "ÿßŸÑŸÅÿ¥ŸÜ",
    "ÿ≥ŸÖÿ≥ÿ∑ÿß",
  ],
  ÿßŸÑŸÖŸÜŸäÿß: [
    "ÿßŸÑŸÖŸÜŸäÿß",
    "ŸÖŸÑŸàŸä",
    "ŸÖÿ∫ÿßÿ∫ÿ©",
    "ÿ®ŸÜŸä ŸÖÿ≤ÿßÿ±",
    "ÿ≥ŸÖÿßŸÑŸàÿ∑",
    "ÿ£ÿ®Ÿà ŸÇÿ±ŸÇÿßÿµ",
    "ÿØŸäÿ±ŸÖŸàÿßÿ≥",
    "ÿßŸÑÿπÿØŸàÿ©",
    "ŸÖÿ∑ÿßŸä",
  ],
  ÿ£ÿ≥ŸäŸàÿ∑: [
    "ÿ£ÿ≥ŸäŸàÿ∑",
    "ÿØŸäÿ±Ÿàÿ∑",
    "ÿßŸÑŸÇŸàÿµŸäÿ©",
    "ÿ£ÿ®ŸÜŸàÿ®",
    "ŸÖŸÜŸÅŸÑŸàÿ∑",
    "ÿ£ÿ®Ÿà ÿ™Ÿäÿ¨",
    "ÿßŸÑÿ∫ŸÜÿßŸäŸÖ",
    "ÿ≥ÿßÿ≠ŸÑ ÿ≥ŸÑŸäŸÖ",
    "ÿßŸÑÿ®ÿØÿßÿ±Ÿä",
    "ÿµÿØŸÅÿß",
    "ÿßŸÑŸÅÿ™ÿ≠",
  ],
  ÿ≥ŸàŸáÿßÿ¨: [
    "ÿ≥ŸàŸáÿßÿ¨",
    "ÿ¨ÿ±ÿ¨ÿß",
    "ÿ∑ŸÖŸá",
    "ÿ∑Ÿáÿ∑ÿß",
    "ÿßŸÑŸÖÿ±ÿßÿ∫ÿ©",
    "ÿßŸÑÿ®ŸÑŸäŸÜÿß",
    "ÿßŸÑŸÖŸÜÿ¥ÿ£ÿ©",
    "ÿ£ÿÆŸÖŸäŸÖ",
    "ÿ≥ÿßŸÇŸÑÿ™ÿ©",
    "ÿØÿßÿ± ÿßŸÑÿ≥ŸÑÿßŸÖ",
    "ÿ¨ŸáŸäŸÜÿ©",
  ],
  ŸÇŸÜÿß: [
    "ŸÇŸÜÿß",
    "ŸÜÿ¨ÿπ ÿ≠ŸÖÿßÿØŸä",
    "ÿØÿ¥ŸÜÿß",
    "ŸÇŸàÿµ",
    "ŸÅÿ±ÿ¥Ÿàÿ∑",
    "ŸÇŸÅÿ∑",
    "ŸÜŸÇÿßÿØÿ©",
    "ÿßŸÑŸàŸÇŸÅ",
    "ÿ£ÿ®Ÿà ÿ™ÿ¥ÿ™",
  ],
  ÿßŸÑÿ£ŸÇÿµÿ±: ["ÿßŸÑÿ£ŸÇÿµÿ±", "ÿ•ÿ≥ŸÜÿß", "ÿ£ÿ±ŸÖŸÜÿ™", "ÿßŸÑŸÇÿ±ŸÜÿ©", "ÿ∑Ÿäÿ®ÿ©", "ÿßŸÑÿ≤ŸäŸÜŸäÿ©", "ÿßŸÑÿ®Ÿäÿßÿ∂Ÿäÿ©"],
  ÿ£ÿ≥ŸàÿßŸÜ: ["ÿ£ÿ≥ŸàÿßŸÜ", "ŸÉŸàŸÖ ÿ£ŸÖÿ®Ÿà", "ÿ•ÿØŸÅŸà", "ŸÜÿµÿ± ÿßŸÑŸÜŸàÿ®ÿ©", "ÿØÿ±ÿßŸà", "ÿ£ÿ®Ÿà ÿ≥ŸÖÿ®ŸÑ"],
  "ÿßŸÑÿ®ÿ≠ÿ± ÿßŸÑÿ£ÿ≠ŸÖÿ±": [
    "ÿßŸÑÿ∫ÿ±ÿØŸÇÿ©",
    "ÿßŸÑÿ¨ŸàŸÜÿ©",
    "ÿ≥ŸÅÿßÿ¨ÿß",
    "ÿßŸÑŸÇÿµŸäÿ±",
    "ŸÖÿ±ÿ≥Ÿâ ÿπŸÑŸÖ",
    "ÿ±ÿ£ÿ≥ ÿ∫ÿßÿ±ÿ®",
    "ÿ≠ŸÑÿßŸäÿ®",
    "ÿ¥ŸÑÿßÿ™ŸäŸÜ",
  ],
  "ÿ¨ŸÜŸàÿ® ÿ≥ŸäŸÜÿßÿ°": [
    "ÿ¥ÿ±ŸÖ ÿßŸÑÿ¥ŸäÿÆ",
    "ÿØŸáÿ®",
    "ŸÜŸàŸäÿ®ÿπ",
    "ÿ∑ÿßÿ®ÿß",
    "ÿ∑Ÿàÿ± ÿ≥ŸäŸÜÿßÿ°",
    "ÿ≥ÿßŸÜÿ™ ŸÉÿßÿ™ÿ±ŸäŸÜ",
    "ÿ±ÿ£ÿ≥ ÿ≥ÿØÿ±",
    "ÿ£ÿ®Ÿà ÿ±ÿØŸäÿ≥",
    "ÿ£ÿ®Ÿà ÿ≤ŸÜŸäŸÖÿ©",
  ],
  ŸÖÿ∑ÿ±Ÿàÿ≠: [
    "ŸÖÿ±ÿ≥Ÿâ ŸÖÿ∑ÿ±Ÿàÿ≠",
    "ÿßŸÑÿπŸÑŸÖŸäŸÜ",
    "ŸÖÿßÿ±ŸäŸÜÿß",
    "ÿßŸÑÿ∂ÿ®ÿπÿ©",
    "ÿ≥ŸäŸàÿ©",
    "ÿßŸÑÿ≠ŸÖÿßŸÖ",
    "ÿßŸÑŸÜÿ¨ŸäŸÑÿ©",
    "ÿßŸÑÿ≥ŸÑŸàŸÖ",
    "ÿ®ÿ±ÿßŸÜŸä",
  ],
  "ÿßŸÑŸàÿßÿØŸä ÿßŸÑÿ¨ÿØŸäÿØ": ["ÿßŸÑÿÆÿßÿ±ÿ¨ÿ©", "ÿßŸÑÿØÿßÿÆŸÑÿ©", "ÿßŸÑŸÅÿ±ÿßŸÅÿ±ÿ©", "ÿ®ÿßÿ±Ÿäÿ≥", "ÿ®ŸÑÿßÿ∑"],
  "ÿ¥ŸÖÿßŸÑ ÿ≥ŸäŸÜÿßÿ°": ["ÿßŸÑÿπÿ±Ÿäÿ¥", "ÿßŸÑÿ¥ŸäÿÆ ÿ≤ŸàŸäÿØ", "ÿ±ŸÅÿ≠", "ÿ®ÿ¶ÿ± ÿßŸÑÿπÿ®ÿØ", "ÿßŸÑÿ≠ÿ≥ŸÜÿ©", "ŸÜÿÆŸÑ"],
};
let selectedFiles = [];
let map, marker, circle;
let isMapEnabled = false;

document.addEventListener("DOMContentLoaded", async () => {
  await fetchUserData();

  setupArabicNumbersSupport();
  initLocationSelects();

  const catSelect = document.getElementById("property-category");
  if (catSelect) {
    catSelect.addEventListener("change", toggleFields);
    toggleFields();
  }

  initMap(true);

  checkLocationOnLoad();
});
function initLocationSelects() {
  const govSelect = document.getElementById("gov-select");
  const citySelect = document.getElementById("city-select");

  Object.keys(egyptLocations).forEach((gov) => {
    const option = document.createElement("option");
    option.value = gov;
    option.textContent = gov;
    govSelect.appendChild(option);
  });

  govSelect.addEventListener("change", function () {
    const selectedGov = this.value;
    citySelect.innerHTML = '<option value="">ÿßÿÆÿ™ÿ± ÿßŸÑŸÖÿØŸäŸÜÿ©...</option>';

    if (selectedGov && egyptLocations[selectedGov]) {
      egyptLocations[selectedGov].forEach((city) => {
        const option = document.createElement("option");
        option.value = city;
        option.textContent = city;
        citySelect.appendChild(option);
      });
    }
  });
}

function showStatusModal(
  type,
  title,
  subtitle,
  note = "",
  marketingDesc = "",
  location = ""
) {
  const oldModal = document.querySelector(".status-modal-overlay");
  if (oldModal) oldModal.remove();

  let config = {};
  if (type === "review") {
    config = {
      color: "#ffc107",
      icon: "fas fa-clock",
      animation: "fa-pulse",
      bgGradient:
        "linear-gradient(135deg, rgba(255,193,7,0.1), rgba(0,0,0,0.8))",
      btnText: "ÿ≠ÿ≥ŸÜÿßŸãÿå ŸÅŸáŸÖÿ™",
    };
  } else if (type === "success") {
    config = {
      color: "#00ff88",
      icon: "fas fa-check-circle",
      animation: "fa-bounce",
      bgGradient:
        "linear-gradient(135deg, rgba(0,255,136,0.1), rgba(0,0,0,0.8))",
      btnText: "ŸÖŸÖÿ™ÿßÿ≤ÿå ÿπÿ±ÿ∂ ÿßŸÑÿπŸÇÿßÿ±",
    };
  } else if (type === "error") {
    config = {
      color: "#ff4444",
      icon: "fas fa-times-circle",
      animation: "fa-shake",
      bgGradient:
        "linear-gradient(135deg, rgba(255,68,68,0.1), rgba(0,0,0,0.8))",
      btnText: "ÿ•ÿ∫ŸÑÿßŸÇ Ÿàÿ™ÿµÿ≠Ÿäÿ≠",
    };
  }

  const modalHTML = `
        <div class="status-modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; background: rgba(0,0,0,0.85); backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; animation: fadeIn 0.3s;">
            <div class="status-modal-content" style="background: #1a1a1a; width: 90%; max-width: 450px; padding: 30px; border-radius: 20px; text-align: center; border: 1px solid ${
              config.color
            }; box-shadow: 0 0 30px ${
    config.color
  }40; position: relative; overflow: hidden;">
                <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: ${
                  config.bgGradient
                }; z-index: 0;"></div>
                <div style="position: relative; z-index: 1;">
                    <div style="font-size: 4rem; color: ${
                      config.color
                    }; margin-bottom: 20px;"><i class="${config.icon} ${
    config.animation
  }"></i></div>
                    <h2 style="color: white; margin-bottom: 10px; font-family: 'Cairo', sans-serif;">${title}</h2>
                    <p style="color: #ccc; font-size: 1rem; line-height: 1.6; margin-bottom: 20px;">${subtitle}</p>
                    ${
                      marketingDesc
                        ? `<div style="background: rgba(255,255,255,0.05); border-right: 3px solid #00ff88; padding: 15px; border-radius: 8px; margin: 15px 0; text-align: right;"><strong style="color: #00ff88; font-size: 0.85rem;"><i class="fas fa-magic"></i> ÿßŸÑŸàÿµŸÅ ÿßŸÑŸÖÿ≠ÿ≥ŸÜ:</strong><p style="color: #ddd; font-size: 0.9rem; margin-top: 5px; font-style: italic;">"${marketingDesc}"</p></div>`
                        : ""
                    }
                    ${
                      note
                        ? `<div style="background: rgba(255, 193, 7, 0.1); border: 1px dashed #ffc107; padding: 10px; border-radius: 8px; margin-bottom: 20px;"><span style="color: #ffc107; font-size: 0.9rem;">${note}</span></div>`
                        : ""
                    }
                    <button onclick="${
                      type === "error"
                        ? "closeModal()"
                        : "window.location.href='home'"
                    }" style="background: ${
    config.color
  }; color: #000; border: none; padding: 12px 35px; border-radius: 50px; font-weight: bold; font-size: 1rem; cursor: pointer; transition: 0.3s; box-shadow: 0 5px 15px ${
    config.color
  }40;">${config.btnText}</button>
                </div>
            </div>
        </div>
        <style>@keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }</style>
    `;
  document.body.insertAdjacentHTML("beforeend", modalHTML);
}
function closeModal() {
  const modal = document.querySelector(".status-modal-overlay");
  if (modal) modal.remove();
}

function setupArabicNumbersSupport() {
  const targetInputs = document.querySelectorAll(
    'input[name="propertyPrice"], input[name="propertyArea"], input[name="propertyRooms"], input[name="propertyBathrooms"], input[name="propertyFloors"]'
  );

  targetInputs.forEach((input) => {
    input.style.direction = "ltr";
    input.style.textAlign = "right";
    input.setAttribute("placeholder", "0");

    input.addEventListener("input", function (e) {
      let val = this.value;

      const arabicNumbers = ["Ÿ†", "Ÿ°", "Ÿ¢", "Ÿ£", "Ÿ§", "Ÿ•", "Ÿ¶", "Ÿß", "Ÿ®", "Ÿ©"];
      const persianNumbers = ["€∞", "€±", "€≤", "€≥", "€¥", "€µ", "€∂", "€∑", "€∏", "€π"];

      val = val.replace(/[Ÿ†-Ÿ©]/g, (d) => arabicNumbers.indexOf(d));
      val = val.replace(/[€∞-€π]/g, (d) => persianNumbers.indexOf(d));

      val = val.replace(/[^0-9]/g, "");

      if (this.value !== val) {
        this.value = val;
      }
    });

    input.addEventListener("paste", function (e) {
      e.preventDefault();
      let pastedData = (e.clipboardData || window.clipboardData).getData(
        "text"
      );
      pastedData = pastedData
        .replace(/[Ÿ†-Ÿ©]/g, (d) => "0123456789"["Ÿ†Ÿ°Ÿ¢Ÿ£Ÿ§Ÿ•Ÿ¶ŸßŸ®Ÿ©".indexOf(d)])
        .replace(/[^0-9]/g, "");
      document.execCommand("insertText", false, pastedData);
    });
  });
}

function toggleFields() {
  const category = document.getElementById("property-category").value;

  const groups = {
    level: document.getElementById("level-group"),
    buildingDetails: document.getElementById("building-details-group"),
    rooms: document.getElementById("rooms-group"),
    finish: document.getElementById("finishing-group"),
    landType: document.getElementById("land-type-group"),
  };

  Object.values(groups).forEach((g) => {
    if (g) g.style.display = "none";
  });

  switch (category) {
    case "apartment":
    case "duplex":
    case "office":
      if (groups.level) groups.level.style.display = "block";
      if (groups.rooms) groups.rooms.style.display = "flex";
      if (groups.finish) groups.finish.style.display = "block";
      break;

    case "villa":
    case "chalet":
      if (groups.rooms) groups.rooms.style.display = "flex";
      if (groups.finish) groups.finish.style.display = "block";
      break;

    case "building":
      if (groups.buildingDetails) groups.buildingDetails.style.display = "flex";
      if (groups.finish) groups.finish.style.display = "block";
      break;

    case "land":
      if (groups.landType) groups.landType.style.display = "block";
      break;

    case "store":
    case "warehouse":
      if (groups.finish) groups.finish.style.display = "block";
      break;

    default:
      if (groups.rooms) groups.rooms.style.display = "flex";
      if (groups.finish) groups.finish.style.display = "block";
  }
}
function initMap(startDisabled = false) {
  const defaultLat = 30.0444;
  const defaultLng = 31.2357;

  map = L.map("map").setView([defaultLat, defaultLng], 13);

  L.tileLayer(
    "https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",
    {
      attribution: "&copy; OpenStreetMap contributors",
      maxZoom: 20,
    }
  ).addTo(map);

  map.on("click", async function (e) {
    if (!isMapEnabled) return;
    handleLocationSelect(e.latlng.lat, e.latlng.lng);
  });

  const searchInput = document.getElementById("map-search-input");
  if (searchInput) {
    searchInput.addEventListener("keypress", function (e) {
      if (!isMapEnabled) return;
      if (e.key === "Enter") {
        e.preventDefault();
        searchLocation();
      }
    });
    searchInput.addEventListener("input", function () {
      if (!isMapEnabled) return;
      if (this.value.length < 3)
        document.getElementById("search-suggestions").style.display = "none";
    });
  }

  if (startDisabled) {
    disableMapUI();
  }
}
async function searchLocation() {
  const query = document.getElementById("map-search-input").value;
  const resultsBox = document.getElementById("search-suggestions");

  if (!query) {
    resultsBox.style.display = "none";
    return;
  }

  const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(
    query + ", Egypt"
  )}&addressdetails=1&limit=5&accept-language=ar`;

  try {
    resultsBox.style.display = "block";
    resultsBox.innerHTML =
      '<div class="suggestion-item" style="justify-content:center; color:#00ff88;"><i class="fas fa-spinner fa-spin"></i> ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ®ÿ≠ÿ´...</div>';

    const response = await fetch(url);
    const data = await response.json();

    resultsBox.innerHTML = "";

    if (data.length === 0) {
      resultsBox.innerHTML =
        '<div class="suggestion-item" style="color:#ff4444; justify-content:center;">ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ŸÜÿ™ÿßÿ¶ÿ¨.</div>';
      setTimeout(() => (resultsBox.style.display = "none"), 3000);
      return;
    }

    data.forEach((place) => {
      const div = document.createElement("div");
      div.className = "suggestion-item";
      let displayName = place.display_name.split(",").slice(0, 3).join("ÿå ");
      div.innerHTML = `<i class="fas fa-map-marker-alt"></i> <span>${displayName}</span>`;
      div.onclick = () => {
        document.getElementById("map-search-input").value = displayName;
        handleLocationSelect(place.lat, place.lon);
        resultsBox.style.display = "none";
      };
      resultsBox.appendChild(div);
    });
  } catch (error) {
    resultsBox.style.display = "none";
  }
}

async function handleLocationSelect(lat, lng) {
  map.setView([lat, lng], 17);

  if (marker) map.removeLayer(marker);
  if (circle) map.removeLayer(circle);

  marker = L.marker([lat, lng])
    .addTo(map)
    .bindPopup("ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑŸÖÿ≠ÿØÿØ")
    .openPopup();
  circle = L.circle([lat, lng], {
    color: "#00ff88",
    fillColor: "#00ff88",
    fillOpacity: 0.1,
    radius: 500,
  }).addTo(map);

  document.getElementById("lat").value = lat;
  document.getElementById("lng").value = lng;
  document.getElementById("search-suggestions").style.display = "none";

  await fetchNearbyServices(lat, lng);
}

async function fetchNearbyServices(lat, lng) {
  const statusMsg = document.getElementById("map-status-text");
  statusMsg.innerHTML =
    '<i class="fas fa-spinner fa-spin"></i> ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÖŸÜÿ∑ŸÇÿ© ÿ®ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä...';
  statusMsg.style.color = "#00d4ff";

  const query = `
        [out:json];
        (
          node["amenity"~"school|hospital|university|bank|pharmacy|cafe|gym|place_of_worship"](around:800, ${lat}, ${lng});
          way["amenity"~"school|hospital|university|bank|pharmacy|cafe|gym|place_of_worship"](around:800, ${lat}, ${lng});
          node["shop"~"supermarket|mall|bakery|clothes"](around:800, ${lat}, ${lng});
          way["shop"~"supermarket|mall|bakery|clothes"](around:800, ${lat}, ${lng});
        );
        out center 15; 
    `;

  try {
    const response = await fetch("https://overpass-api.de/api/interpreter", {
      method: "POST",
      body: query,
    });
    const data = await response.json();

    const services = new Set();
    data.elements.forEach((el) => {
      let name = el.tags["name:ar"] || el.tags.name || null;
      if (name) services.add(name);
    });

    const servicesArray = Array.from(services).slice(0, 10);
    document.getElementById("nearby_services").value = servicesArray.join(", ");

    if (servicesArray.length > 0) {
      statusMsg.innerHTML = `<i class="fas fa-check-circle"></i> ÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ${servicesArray.length} ÿÆÿØŸÖÿßÿ™ ÿ≠ŸäŸàŸäÿ© ÿ≠ŸàŸÑ ÿßŸÑÿπŸÇÿßÿ±!`;
      statusMsg.style.color = "#00ff88";
    } else {
      statusMsg.innerHTML =
        "‚ö†Ô∏è ÿßŸÑŸÖŸÜÿ∑ŸÇÿ© ŸáÿßÿØÿ¶ÿ©ÿå ÿ≥Ÿäÿ™ŸÖ ÿßŸÑÿßÿπÿ™ŸÖÿßÿØ ÿπŸÑŸâ ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä ŸÅŸÇÿ∑.";
      statusMsg.style.color = "#ff9800";
    }
  } catch (error) {
    statusMsg.innerText = "ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä.";
  }
}

window.locateUser = function () {
  const btn = document.querySelector(".locate-fab-btn");
  const icon = btn.querySelector("i");

  icon.className = "fas fa-spinner fa-spin";

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (pos) => {
        handleLocationSelect(pos.coords.latitude, pos.coords.longitude);
        icon.className = "fas fa-check";
        btn.style.color = "#00ff88";
        setTimeout(() => {
          icon.className = "fas fa-crosshairs";
          btn.style.color = "black";
        }, 2000);
      },
      () => {
        alert("Ÿäÿ±ÿ¨Ÿâ ÿ™ŸÅÿπŸäŸÑ ÿßŸÑŸÄ GPS ŸàÿßŸÑÿ≥ŸÖÿßÿ≠ ŸÑŸÑŸÖÿ™ÿµŸÅÿ≠ ÿ®ÿßŸÑŸàÿµŸàŸÑ ŸÑŸÑŸÖŸàŸÇÿπ.");
        icon.className = "fas fa-crosshairs";
      }
    );
  } else {
    alert("ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ ŸÑÿß ŸäÿØÿπŸÖ ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ");
    icon.className = "fas fa-crosshairs";
  }
};
async function fetchUserData() {
  try {
    const response = await fetch("/api/auth/me");
    const data = await response.json();
    if (data.isAuthenticated) {
      document.getElementById("seller-name").value =
        data.name || "ŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿπŸÇÿßÿ±ŸÉ";
      document.getElementById("seller-phone").value = data.phone || "";
    } else {
      window.location.href = "authentication";
    }
  } catch (e) {}
}

const imgInput = document.getElementById("property-images");
if (imgInput) {
  imgInput.addEventListener("change", function (e) {
    const MAX_SIZE = 10 * 1024 * 1024;
    let rejectedCount = 0;

    Array.from(e.target.files).forEach((file) => {
      if (file.size > MAX_SIZE) {
        rejectedCount++;
      } else {
        selectedFiles.push(file);
      }
    });

    if (rejectedCount > 0)
      alert(`‚ö†Ô∏è ÿ™ŸÖ ÿ±ŸÅÿ∂ ${rejectedCount} ÿµŸàÿ±ÿ© ŸÑÿ£ŸÜ ÿ≠ÿ¨ŸÖŸáÿß ÿ£ŸÉÿ®ÿ± ŸÖŸÜ 10 ŸÖŸäÿ¨ÿß.`);
    if (selectedFiles.length > 10) {
      alert("‚ö†Ô∏è ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ŸÇÿµŸâ 10 ÿµŸàÿ± ŸÅŸÇÿ∑ÿå ÿ≥Ÿäÿ™ŸÖ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ£ŸàŸÑ 10 ÿµŸàÿ±.");
      selectedFiles = selectedFiles.slice(0, 10);
    }

    renderPreviews();
    this.value = "";
  });
}

function renderPreviews() {
  const container = document.getElementById("image-preview-container");
  container.innerHTML = "";
  selectedFiles.forEach((file, index) => {
    const div = document.createElement("div");
    div.className = "preview-item";

    const img = document.createElement("img");
    const reader = new FileReader();
    reader.onload = (e) => (img.src = e.target.result);
    reader.readAsDataURL(file);

    const btn = document.createElement("button");
    btn.className = "btn-remove-img";
    btn.innerHTML = '<i class="fas fa-times"></i>';
    btn.onclick = (e) => {
      e.preventDefault();
      selectedFiles.splice(index, 1);
      renderPreviews();
    };

    div.appendChild(img);
    div.appendChild(btn);
    container.appendChild(div);
  });
}

document
  .getElementById("seller-form")
  .addEventListener("submit", async function (e) {
    e.preventDefault();
    const btn = e.target.querySelector('button[type="submit"]');
    const originalText = btn.innerHTML;

    if (selectedFiles.length === 0) {
      alert("üì∏ Ÿäÿ±ÿ¨Ÿâ ÿ•ÿ∂ÿßŸÅÿ© ÿµŸàÿ±ÿ© Ÿàÿßÿ≠ÿØÿ© ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ ŸÑŸÑÿπŸÇÿßÿ±.");
      return;
    }

    btn.innerHTML =
      '<i class="fas fa-circle-notch fa-spin"></i> ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ© ŸàÿßŸÑŸÜÿ¥ÿ±...';
    btn.classList.add("btn-loading");
    btn.disabled = true;

    const formData = new FormData(e.target);
    formData.delete("images[]");
    selectedFiles.forEach((file) => formData.append("images", file));

    try {
      const response = await fetch("/api/submit-seller-property", {
        method: "POST",
        body: formData,
      });
      const result = await response.json();

      if (result.status === "approved") {
        showStatusModal(
          "success",
          result.title,
          result.message,
          "",
          result.marketing_desc,
          result.location
        );
      } else if (result.status === "pending") {
        showStatusModal(
          "review",
          result.title,
          result.message,
          "ÿ™ŸÖ ÿ™ÿ≠ŸàŸäŸÑ ÿ∑ŸÑÿ®ŸÉ ŸÑŸÑŸÖÿ±ÿßÿ¨ÿπÿ© ÿßŸÑŸäÿØŸàŸäÿ© ŸÑŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ®ÿπÿ∂ ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ."
        );
      } else {
        showStatusModal(
          "error",
          result.title || "ÿπÿ∞ÿ±ÿßŸãÿå ŸÖÿ±ŸÅŸàÿ∂",
          result.message || "ÿßŸÑÿ•ÿπŸÑÿßŸÜ ŸÑÿß Ÿäÿ∑ÿßÿ®ŸÇ ÿ≥Ÿäÿßÿ≥ÿßÿ™ ÿßŸÑŸÜÿ¥ÿ±."
        );
      }
    } catch (error) {
      showStatusModal(
        "error",
        "ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ",
        "ÿ™ÿπÿ∞ÿ± ÿßŸÑŸàÿµŸàŸÑ ŸÑŸÑÿ≥Ÿäÿ±ŸÅÿ±ÿå Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™."
      );
    } finally {
      btn.innerHTML = originalText;
      btn.disabled = false;
    }
  });
document.addEventListener("input", function (e) {
  if (
    e.target.type === "number" ||
    e.target.type === "tel" ||
    e.target.classList.contains("number-only")
  ) {
    let val = e.target.value;
    val = val.replace(/[Ÿ†-Ÿ©]/g, (d) => "Ÿ†Ÿ°Ÿ¢Ÿ£Ÿ§Ÿ•Ÿ¶ŸßŸ®Ÿ©".indexOf(d));
    e.target.value = val.replace(/[^0-9.]/g, "");
  }
});

function checkLocationOnLoad() {
  const userDecision = localStorage.getItem("user_loc_preference");

  if (navigator.geolocation) {
    navigator.permissions.query({ name: "geolocation" }).then((result) => {
      if (result.state === "granted") {
        enableMapUI();
        locateUserSilent();
      } else if (result.state === "denied") {
        disableMapUI();
      } else {
        disableMapUI();

        if (userDecision !== "later") {
          openPermModal();
        }
      }

      result.onchange = function () {
        if (this.state === "granted") enableMapUI();
        else disableMapUI();
      };
    });
  } else {
    disableMapUI();
  }
}

function requestLocationAccess() {
  closePermModal();

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (pos) => {
        localStorage.setItem("user_loc_preference", "granted");
        enableMapUI();
        handleLocationSelect(pos.coords.latitude, pos.coords.longitude);
      },
      (err) => {
        console.warn("Location access denied or error:", err);
        disableMapUI();
      },
      { enableHighAccuracy: true }
    );
  } else {
    alert("ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ ŸÑÿß ŸäÿØÿπŸÖ ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ");
  }
}

function locateUserSilent() {
  navigator.geolocation.getCurrentPosition(
    (pos) => {
      handleLocationSelect(pos.coords.latitude, pos.coords.longitude);
    },
    () => {}
  );
}

function enableMapUI() {
  isMapEnabled = true;
  const wrapper = document.querySelector(".map-wrapper");
  if (wrapper) wrapper.classList.remove("map-disabled");

  const searchInput = document.getElementById("map-search-input");
  const searchBtn = document.querySelector(".map-search-btn");
  const locateBtn = document.querySelector(".locate-fab-btn");
  const overlay = document.getElementById("mapLockOverlay");

  if (searchInput) searchInput.disabled = false;
  if (searchBtn) searchBtn.disabled = false;
  if (locateBtn) locateBtn.disabled = false;
  if (overlay) overlay.style.display = "none";
}

function disableMapUI() {
  isMapEnabled = false;
  const wrapper = document.querySelector(".map-wrapper");
  if (wrapper) wrapper.classList.add("map-disabled");

  const searchInput = document.getElementById("map-search-input");
  const searchBtn = document.querySelector(".map-search-btn");
  const locateBtn = document.querySelector(".locate-fab-btn");
  const overlay = document.getElementById("mapLockOverlay");

  if (searchInput) searchInput.disabled = true;
  if (searchBtn) searchBtn.disabled = true;
  if (locateBtn) locateBtn.disabled = true;

  if (overlay) {
    overlay.style.display = "flex";
    overlay.onclick = openPermModal;
  }
}

function openPermModal() {
  const modal = document.getElementById("locationPermModal");
  if (modal) modal.classList.add("show");
}

function closePermModal() {
  const modal = document.getElementById("locationPermModal");
  if (modal) modal.classList.remove("show");

  if (localStorage.getItem("user_loc_preference") !== "granted") {
    localStorage.setItem("user_loc_preference", "later");
  }
}
